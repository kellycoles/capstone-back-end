@model IEnumerable<MowPro.Models.Job>

@{
    ViewData["Title"] = "Index";
}

<h1>Current Jobs</h1>
@if (TempData["Message"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <p class="lead"> @TempData["Message"] </p>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
}
<p>
    <a asp-action="Create">Create New</a>
</p>
@* search box *@
<form asp-action="Index" method="get">
    <div class="form-actions no-color">
        <p>
            <input type="text" name="SearchString" value="@ViewData["currentFilter"]" />
            <input type="submit" value="Search" /> |
            <a asp-action="Index">Back to Full List</a>
        </p>
    </div>
</form>

@* if no records match searchString, don't show table header. *@
@if (Model.Count() != 0)

{
    <div class="card-deck">
        @foreach (var item in Model)
        {

            <div class="card  mb-4 ml-auto mr-auto"  style="min-width: 18rem; max-width:30.5%;">
                <iframe class="card-img-top" style="border:none" src="@($"https://maps.google.com/maps?q={item.Customer.StreetAddress}&t=&z=13&ie=UTF8&iwloc=&output=embed")"></iframe>
                <div class="card-body">
                    <h5 class="card-title"> @Html.DisplayFor(modelItem => item.Service.Name)</h5>
                    <dl class="row">
                        <dt class="col-sm-6 card-text">@Html.DisplayNameFor(model => model.Date):</dt>
                        <dd class="col-sm-6 card-text">@Html.DisplayFor(modelItem => item.Date)</dd>
                        <dt class="col-sm-6 card-text">@Html.DisplayNameFor(model => model.Customer):</dt>
                        <dd class="col-sm-6 card-text"><a asp-action="Details" asp-controller="Customers" asp-route-id="@item.CustomerId">@Html.DisplayFor(modelItem => item.Customer.FullName)</a></dd>
                        <dt class="col-sm-6 card-text">@Html.DisplayNameFor(model => model.Cost):</dt>
                        <dd class="col-sm-6 card-text">@Html.DisplayFor(modelItem => item.Cost)</dd>
                        <dt class="col-sm-6 card-text">@Html.DisplayNameFor(model => model.Customer.Preferences):</dt>
                        <dd class="col-sm-6 card-text">@Html.DisplayFor(modelItem => item.Customer.Preferences)</dd>
                    </dl>
                    <a asp-action="CompleteJob" asp-route-id="@item.JobId" class="btn btn-sm btn-primary">Complete Job</a>
                 
                </div>
                <div class="card-footer  text-center">
                    <small class="text-muted">
                        <a asp-action="Edit" asp-route-id="@item.JobId">Edit</a> |
                        <a asp-action="Details" asp-route-id="@item.JobId">Details</a> |
                        <a asp-action="Delete" asp-route-id="@item.JobId">Delete</a>
                    </small>
                </div>
            </div>





            @*<table class="table">
                    <thead>
                        <tr>
                            <th>
                                @Html.DisplayNameFor(model => model.Date)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.Customer)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.Service)
                            </th>

                            <th>
                                @Html.DisplayNameFor(model => model.Cost)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.IsComplete)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.Paid)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.Customer.StreetAddress)
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td>
                                    @Html.DisplayFor(modelItem => item.Date)
                                </td>
                                <td>
                                    <a asp-action="Details" asp-controller="Customers" asp-route-id="@item.CustomerId">@Html.DisplayFor(modelItem => item.Customer.FullName)</a>
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.Service.Name)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.Cost)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.IsComplete)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.Paid)
                                </td>

                                <td>
                                    <a href="@($"https://maps.google.com/maps?q={item.Customer.StreetAddress}")" target="_blank"> @Html.DisplayFor(modelItem => item.Customer.StreetAddress)</a>
                                </td>
                                <td>
                                    <a asp-action="Edit" asp-route-id="@item.JobId">Edit</a> |
                                    <a asp-action="Details" asp-route-id="@item.JobId">Details</a> |
                                    <a asp-action="Delete" asp-route-id="@item.JobId">Delete</a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>*@
        }

    </div>
}
else
{
    <p class="alert-info lead">There are no records containing: @ViewData["currentFilter"]</p>
}
